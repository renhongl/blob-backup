{"compress":true,"commitItems":[["a31ea484-e29c-405e-824b-328925f12cb4",1548839202091,"---\ntitle: NodeJS刷票程序\ndate: 2017-01-08 17:07:46\ntags:\n    - 分享\n    - Nodejs\n---\n\n![buy_ticket](/images/buyTicket.jpg)\n\n\n## 简介\n\n这是一个脚本程序，运行在NodeJS环境之上，功能类似360抢票王。\n\n\n## 安装\n\n假设已经安装了node环境，从github上clone下源代码（[源码在这](https://github.com/renhongl/Buy_Ticket)）\n\n运行`npm install`安装依赖\n\n双击run.bat即可\n\n## 效果\n\n控制台每隔30秒打印最新票量信息，如果没有票，显示 **No data found**，如果有，则一一列出来。根目录文件夹也会生成一个log.txt文件，方便查看之前刷票的结果。在有票的时候，还会通过短信告知用户，效果图在文章开始已经列出。\n\n## 代码\n\n代码主要是通过request模块从携程网的查询票量的API中获取数据，经过筛选数据后，将符合要求的数据发给用户。\n\n### 发送短信的代码：\n\n  ```\n\tvar App = require('alidayu-node');\n\tvar app = new App('App Key', 'App Secret');\n\n    var message = JSON.stringify({\n        \"name\": \"lrh\",\n        \"trainName\": 'D5154',\n        \"number\": '2'\n    });\n\n    var smsOptions = {\n        sms_free_sign_name: '提示信息',\n        sms_param: message,\n        rec_num: '81193903',\n        sms_template_code: 'SMS_39010188'\n    };\n    app.smsSend(options);\n  ```\n\n这是使用的阿里大于的API，在官网注册账号后，需要创建新应用获取**App Key**和 **App Secret**，接着需要为自己的短信申请签名和模板。申请成功后，就可以用上面的方式来发送短信了。\n\n",[[1548839186494,["P1211678@NCS-100918JJ01",[[-1,121,"#"]],[122,122],[121,121]]],[1548839187985,["P1211678@NCS-100918JJ01",[[-1,164,"#"]],[165,165],[164,164]]],[1548839191446,["P1211678@NCS-100918JJ01",[[-1,285,"#"]],[286,286],[285,285]]],[1548839194487,["P1211678@NCS-100918JJ01",[[-1,413,"#"]],[414,414],[413,413]]],[1548839202770,["P1211678@NCS-100918JJ01",[[-1,478,"#"]],[479,479],[478,478]]],[1548839215956,["P1211678@NCS-100918JJ01",[[-1,412,"# 代码\n\n代码主要是通过request模块从携程网的查询票量的API中获取数据，经过筛选数据后，将符合要求的数据发给用户。"]],[412,474],[412,412]]],[1548839217489,["P1211678@NCS-100918JJ01",[[-1,415,"#"]],[416,416],[415,415]]],[1548839219457,["P1211678@NCS-100918JJ01",[[1,431,"js"]],[431,431],[433,433]]]],null,"P1211678@NCS-100918JJ01"]]}